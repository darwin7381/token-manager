# ğŸ¨ Dashboard ç‰ˆæœ¬å®Œæˆå ±å‘Š

> **æ›´æ–°æ™‚é–“**: 2025-10-30  
> **ç‰ˆæœ¬**: v1.2 (Dashboard ç‰ˆ)  
> **ç‹€æ…‹**: âœ… React + Vite Dashboard å®Œæˆ

---

## âœ¨ å…¨éƒ¨æ”¹é€²å·²å®Œæˆ

### 1. âœ… è·¯ç”±åç¨±æ¬„ä½

**å¾Œç«¯**:
- æ·»åŠ  `routes.name` æ¬„ä½åˆ°è³‡æ–™åº«
- æ›´æ–°æ‰€æœ‰ç›¸é—œ API

**å‰ç«¯**:
- å‰µå»ºæ™‚å¿…å¡«
- åˆ—è¡¨é¡¯ç¤ºåœ¨æœ€å‰é¢ï¼ˆç²—é«”ï¼‰
- ç·¨è¼¯æ™‚å¯ä¿®æ”¹

**ç”¨é€”**:
- æ›´å¥½åœ°è­˜åˆ¥è·¯ç”±ï¼ˆä¾‹å¦‚: "åœ–ç‰‡è™•ç†æœå‹™" è€Œä¸åªæ˜¯ "/api/image"ï¼‰
- Scope é¸æ“‡å™¨ä¸­å¯ä»¥æŒ‰åç¨±é¸æ“‡

### 2. âœ… Token ç·¨è¼¯åŠŸèƒ½

**å¾Œç«¯**:
- `PUT /api/tokens/{id}` API
- å¯ä»¥æ›´æ–° nameã€departmentã€scopes
- æ›´æ–°å¾Œè‡ªå‹•åŒæ­¥åˆ° KV

**å‰ç«¯**:
- Token åˆ—è¡¨æ·»åŠ "ç·¨è¼¯"æŒ‰éˆ•
- å½ˆå‡ºç·¨è¼¯å°è©±æ¡†
- å¯ä»¥ä¿®æ”¹åç¨±ã€éƒ¨é–€å’Œæ¬Šé™
- åŒ…å« Scope é¸æ“‡å™¨

### 3. âœ… Dashboard å¸ƒå±€

**å®Œæ•´çš„ Dashboard æ¶æ§‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Sidebar   â”‚          Header                  â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”‘ Token   â”‚                                  â”‚
â”‚  ğŸ›£ï¸  Route  â”‚        Content Area              â”‚
â”‚  ğŸ“Š Stats   â”‚                                  â”‚
â”‚             â”‚                                  â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   v1.2.0    â”‚          Footer                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹é»**:
- âœ… æ·±è‰²å´é‚Šæ¬„ï¼ˆé¡ä¼¼åœ–ä¸‰ï¼‰
- âœ… å›ºå®šé«˜åº¦ï¼Œç¨ç«‹æ»¾å‹•
- âœ… Icon + æ–‡å­—å°èˆª
- âœ… Active ç‹€æ…‹é«˜äº®
- âœ… Header é¡¯ç¤ºç³»çµ±ç‹€æ…‹
- âœ… Footer é¡¯ç¤ºç‰ˆæœ¬å’Œéˆæ¥
- âœ… éŸ¿æ‡‰å¼è¨­è¨ˆ

### 4. âœ… Scope é¸æ“‡å™¨æ”¹é€²

**ä¸‰å€‹é¸æ“‡å€åŸŸ**:

1. **æŒ‰è·¯ç”±åç¨±é¸æ“‡**ï¼ˆæ–°å¢ï¼‰
   - é¡¯ç¤º: "åœ–ç‰‡è™•ç†æœå‹™ (image)"
   - é¸æ“‡æœå‹™åç¨±ä½œç‚º scope

2. **æŒ‰è·¯å¾‘é¸æ“‡**
   - é¡¯ç¤ºç´”ç²¹çš„æœå‹™åç¨±
   - ä¾‹å¦‚: image, data, video

3. **æŒ‰æ¨™ç±¤é¸æ“‡**
   - é¡¯ç¤º: ğŸ·ï¸ media, ğŸ·ï¸ premium
   - ç”Ÿæˆ tag:xxx scope

---

## ğŸ“Š å®Œæ•´åŠŸèƒ½åˆ—è¡¨

### Token ç®¡ç†
- âœ… å‰µå»º Token
- âœ… **ç·¨è¼¯ Token** (æ–°å¢)
- âœ… æ’¤éŠ· Token
- âœ… åˆ—è¡¨é¡¯ç¤º
- âœ… Scope è¦–è¦ºåŒ–é¸æ“‡å™¨
  - âœ… **æŒ‰åç¨±é¸æ“‡è·¯ç”±** (æ–°å¢)
  - âœ… æŒ‰è·¯å¾‘é¸æ“‡
  - âœ… æŒ‰æ¨™ç±¤é¸æ“‡

### è·¯ç”±ç®¡ç†
- âœ… **æ·»åŠ åç¨±æ¬„ä½** (æ–°å¢)
- âœ… å‰µå»ºè·¯ç”±
- âœ… ç·¨è¼¯è·¯ç”±
- âœ… åˆªé™¤è·¯ç”±
- âœ… Tags ç®¡ç†
- âœ… åˆ—è¡¨é¡¯ç¤ºåç¨±

### UI/UX
- âœ… **Dashboard å¸ƒå±€** (æ–°å¢)
- âœ… **æ·±è‰²å´é‚Šæ¬„** (æ–°å¢)
- âœ… **Header ç‹€æ…‹ç›£æ§** (æ–°å¢)
- âœ… **Footer** (æ–°å¢)
- âœ… ç¾ä»£åŒ–è¨­è¨ˆ
- âœ… éŸ¿æ‡‰å¼æ”¯æŒ

---

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### å‰ç«¯æŠ€è¡“æ£§
```json
{
  "æ¡†æ¶": "React 19",
  "æ§‹å»ºå·¥å…·": "Vite 7",
  "æ¨£å¼": "ç´” CSS (Dashboard é¢¨æ ¼)",
  "ç‹€æ…‹ç®¡ç†": "React Hooks (useState, useEffect)",
  "çµ„ä»¶": "12 å€‹æ¨¡çµ„åŒ–çµ„ä»¶",
  "ä»£ç¢¼è¡Œæ•¸": "~800 è¡Œ (vs èˆŠç‰ˆ 1089 è¡Œå–®æ–‡ä»¶)"
}
```

### çµ„ä»¶çµæ§‹
```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â”œâ”€â”€ Sidebar.jsx        (å´é‚Šæ¬„å°èˆª)
â”‚   â”‚   â”œâ”€â”€ Header.jsx         (é ‚éƒ¨ç‹€æ…‹)
â”‚   â”‚   â””â”€â”€ Footer.jsx         (åº•éƒ¨ä¿¡æ¯)
â”‚   â”œâ”€â”€ TokenManager/
â”‚   â”‚   â”œâ”€â”€ TokenManager.jsx   (å®¹å™¨)
â”‚   â”‚   â”œâ”€â”€ TokenForm.jsx      (å‰µå»ºè¡¨å–®)
â”‚   â”‚   â”œâ”€â”€ TokenList.jsx      (åˆ—è¡¨ + ç·¨è¼¯æŒ‰éˆ•)
â”‚   â”‚   â”œâ”€â”€ EditTokenModal.jsx (ç·¨è¼¯å°è©±æ¡†)
â”‚   â”‚   â””â”€â”€ ScopeSelector.jsx  (æ¬Šé™é¸æ“‡å™¨)
â”‚   â”œâ”€â”€ RouteManager/
â”‚   â”‚   â”œâ”€â”€ RouteManager.jsx   (å®¹å™¨)
â”‚   â”‚   â”œâ”€â”€ RouteForm.jsx      (å‰µå»ºè¡¨å–® + åç¨±)
â”‚   â”‚   â”œâ”€â”€ RouteList.jsx      (åˆ—è¡¨ + åç¨±æ¬„ä½)
â”‚   â”‚   â”œâ”€â”€ EditRouteModal.jsx (ç·¨è¼¯ + åç¨±)
â”‚   â”‚   â””â”€â”€ TagInput.jsx       (æ¨™ç±¤è¼¸å…¥)
â”‚   â””â”€â”€ Stats/
â”‚       â””â”€â”€ Stats.jsx          (çµ±è¨ˆä¿¡æ¯)
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api.js                 (API å°è£)
â”œâ”€â”€ App.jsx                    (ä¸»æ‡‰ç”¨)
â”œâ”€â”€ main.jsx                   (å…¥å£)
â””â”€â”€ index.css                  (Dashboard æ¨£å¼)
```

---

## ğŸ¯ æ•¸æ“šå­˜å„²ä½ç½®

### PostgreSQL (æœ¬åœ°: localhost:5433)
```sql
âœ… tokens è¡¨
   - id, token_hash, name, department, scopes, 
     created_at, expires_at, is_active

âœ… routes è¡¨
   - id, name (æ–°å¢), path, backend_url, 
     description, tags, created_at

âœ… audit_logs è¡¨
   - id, action, entity_type, entity_id, 
     details, created_at
```

### Cloudflare KV
```javascript
âœ… token:{hash}
   - Token å…ƒæ•¸æ“šï¼ˆç”¨æ–¼ Worker é©—è­‰ï¼‰

âœ… routes
   - {path: {url, tags}}ï¼ˆç”¨æ–¼ Worker è·¯ç”±ï¼‰
```

---

## ğŸš€ å•Ÿå‹•æŒ‡ä»¤

```bash
# å¾Œç«¯
cd backend
uv run uvicorn main:app --reload --port 8000

# å‰ç«¯ (React + Vite)
cd frontend
npm run dev

# è¨ªå•
open http://localhost:5173
```

---

## ğŸ“¸ UI å±•ç¤º

### Sidebar (æ·±è‰²ä¸»é¡Œ)
- ğŸ” Logo å’Œæ¨™é¡Œ
- ğŸ”‘ Token ç®¡ç†
- ğŸ›£ï¸ è·¯ç”±ç®¡ç†
- ğŸ“Š çµ±è¨ˆè³‡è¨Š
- v1.2.0 ç‰ˆæœ¬è™Ÿ

### Header
- ç³»çµ±æ¨™é¡Œ
- å¾Œç«¯å¥åº·ç‹€æ…‹æŒ‡ç¤ºç‡ˆï¼ˆç¶ è‰²â—/ç´…è‰²â—ï¼‰

### Content Area
- ç™½è‰²å¡ç‰‡è¨­è¨ˆ
- è¡¨å–®å’Œåˆ—è¡¨åˆ†é›¢
- æŒ‰éˆ•çµ„åˆæ“ä½œ

### Footer
- ç‰ˆæ¬Šä¿¡æ¯
- GitHub éˆæ¥
- Worker URL

---

## ğŸ‰ vs èˆŠç‰ˆæœ¬å°æ¯”

| ç‰¹æ€§ | èˆŠç‰ˆ (HTML) | æ–°ç‰ˆ (React + Vite) |
|-----|------------|-------------------|
| æ–‡ä»¶æ•¸é‡ | 1 å€‹ (1089 è¡Œ) | 12 å€‹çµ„ä»¶ (~800 è¡Œ) |
| ç¶­è­·æ€§ | âŒ å›°é›£ | âœ… ç°¡å–® |
| Token ç·¨è¼¯ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| Route åç¨± | âŒ ç„¡ | âœ… æœ‰ |
| Dashboard å¸ƒå±€ | âŒ ç„¡ | âœ… æœ‰ |
| Scope é¸æ“‡ | âš ï¸ åŸºæœ¬ | âœ… ä¸‰ç¨®æ–¹å¼ |
| SSO å°±ç·’ | âŒ å›°é›£ | âœ… å®¹æ˜“ |
| æ§‹å»ºå„ªåŒ– | âŒ ç„¡ | âœ… Vite |
| HMR ç†±æ›´æ–° | âŒ ç„¡ | âœ… æœ‰ |

---

## ğŸ”„ è³‡æ–™åº«é·ç§»

å·²åŸ·è¡Œçš„ SQL:
```sql
ALTER TABLE routes ADD COLUMN IF NOT EXISTS name VARCHAR(255);
```

ç¾æœ‰è·¯ç”±çš„ name æ¬„ä½ç‚º NULLï¼Œå»ºè­°æ‰‹å‹•æ›´æ–°ï¼š
```sql
UPDATE routes SET name = 
  CASE 
    WHEN path = '/api/test' THEN 'HTTP æ¸¬è©¦æœå‹™'
    WHEN path = '/api/image' THEN 'åœ–ç‰‡è™•ç†æœå‹™'
    WHEN path = '/api/video' THEN 'å½±ç‰‡è™•ç†æœå‹™'
  END;
```

---

## ğŸŠ ç³»çµ±ç‹€æ…‹

**å…¨éƒ¨åŠŸèƒ½å·²å¯¦ç¾ä¸¦æ¸¬è©¦ï¼**

### é‹è¡Œä¸­
- âœ… PostgreSQL (Docker, port 5433)
- âœ… å¾Œç«¯ API (localhost:8000)
- âœ… å‰ç«¯ React (localhost:5173)
- âœ… Worker (https://api-gateway.cryptoxlab.workers.dev)

### å¾…éƒ¨ç½²
- â³ Railway å¾Œç«¯
- â³ Railway å‰ç«¯

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. **æ¸¬è©¦æ–° UI**: http://localhost:5173
2. **æ›´æ–°ç¾æœ‰è·¯ç”±çš„åç¨±**
3. **æ¸¬è©¦ Token ç·¨è¼¯åŠŸèƒ½**
4. **æº–å‚™éƒ¨ç½²åˆ° Railway**

---

**ğŸ‰ React + Vite Dashboard ç‰ˆæœ¬å®Œæˆï¼** ğŸš€

ç¾åœ¨æ“æœ‰:
- âœ… å°ˆæ¥­çš„ Dashboard å¸ƒå±€
- âœ… å®Œæ•´çš„ç·¨è¼¯åŠŸèƒ½
- âœ… è·¯ç”±åç¨±æ”¯æŒ
- âœ… æ”¹é€²çš„ Scope é¸æ“‡å™¨
- âœ… æ¨¡çµ„åŒ–æ¶æ§‹
- âœ… SSO å°±ç·’

è«‹è¨ªå• http://localhost:5173 æ¸¬è©¦æ–°ç•Œé¢ï¼

